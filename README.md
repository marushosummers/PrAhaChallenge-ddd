# 概要
PrAha Challengeの設計課題の雛形に使用するレポジトリです

## Dockerによる環境構築

```
cd .docker
docker compose up -d
docker compose exec backend /bin/bash
```

## 仕様

### チーム
- [ ] 名前がある（1,2,3,4のような数字でなければいけない。重複不可）
- [ ] 名前は3文字以下でなければいけない（チーム1031は存在できない。999まで）
- [ ] 最低でも参加者が3名いなければならない。3名以下になった時の挙動については以下の「チームやペア移動に関する仕様」を参照してください


```
参加者
名前とメールアドレスを持つ
メールアドレスの重複は許容されない
在籍ステータスを持つ。取りうる値は「在籍中」「休会中」「退会済」の3つ
ステータスが「在籍中」以外の場合、どのチームにもペアにも所属してはいけない


ペア
名前がある（a,b,c,d,eのような英文字でなければいけない）
ペア名は1文字でなければいけない
参加者は2名〜3名まで。1名のペアや、4名のペアは存在できない
ペアの人数が変動した時の挙動については以下の「チームやペア移動に関する仕様」を参照してください
ペアは必ず同じチームの参加者から選ばれます（チーム1とチーム2の参加者がペアを組むことはありません）


### チームやペア移動に関する仕様
- [] ユーザの許諾を得ることなくプログラムが勝手にチームやペアを組み替える事とします
チームから参加者が減る場合（他のチームへの移動、休会退会など）
2名以下のチームは存続できないため、参加者は自動的に他のチームに合流する必要がある。合流先は、最も参加人数が少ないチームから自動的に選ばれる
参加人数が同じチームが存在する場合はランダムに選択する
課題の簡略化のため、ユーザにチーム加入の許諾を得ることなくアプリケーションが自動的に（勝手に）チームを組み替えることとする
例えばA,B,Cの3名が所属しているチームがあって、Aさんのステータスを休会中に変更したら、同じチームに所属していたBさんとCさんが自動的に他のチームに割り振られるようなイメージ
チームに参加者が増える場合
特段のルールなし（参加者の上限数はチームに存在しないため）
休会中の参加者が復帰した（在籍ステータス「在籍中」に切り替わった）際に所属するチームは、最も参加人数が少ないチームから自動的に選ばれる。ペアも最も参加人数が少ないペアから自動的に選ばれる
ペアから参加者が減る場合
1名のペアは存在できないため、自動的に他のペアに合流する必要がある。合流先は最も参加人数が少ないペアから自動的に選ばれる
参加人数が同じペアが存在する場合はランダムに選択する
課題の簡略化のため、ユーザにペアの解体や合流の許諾を得ることなくアプリケーションが自動的に（勝手に）ペアを組み替えることとする
ペアに参加者が増える場合
4名のペアは存在できないため、自動的に2つのペアに分解する必要がある


課題
全ての参加者は複数の課題（80個ぐらい）を所有（割り当てられて）いる
例えば参加者Aが課題を80個、参加者Bが課題を80個所有している
課題には、参加者ごとに進捗ステータスがある
進捗ステータスは「未着手、レビュー待ち、完了」いずれかの値を持つ
進捗ステータスはいつでも変更可能
ただし一度「完了」にした進捗ステータスを「レビュー待ち」「未着手」に戻すことはできない
進捗ステータスを変更できるのは、課題の所有者だけ（Aさんの課題1の進捗ステータスを変えられるのはAさんだけ。Aさんの課題1の進捗ステータスをBさんが変更するのは不可能）




課題２

上記の課題で作成したモデル図を元にAPIサーバをnode.js+TypeScriptで「オニオンアーキテクチャ」に沿って実装してください
ある程度オニオンアーキテクチャに準拠する形で実装された、こちらのサンプルレポジトリを使ってみるとお手軽かもしれません！
https://github.com/praha-inc/praha-challenge-template


成果物の仕様

以下の機能を持つこと
参加者の一覧取得、新規追加、更新（少なくとも在籍ステータスを変更できること）、削除
チームの一覧取得、更新（少なくとも所属するペアを変更できること）
ペアの一覧取得、更新（少なくとも所属する参加者を変更できること）
課題の新規追加、更新（少なくとも進捗ステータスを変更できること）、削除
「特定の課題（複数可能）」が「特定の進捗ステータス」になっている参加者の一覧を、10人単位でページングして取得する
例１：「設計原則（SOLID）」と「DBモデリング１」を「レビュー完了」している参加者一覧を取得する
例２：「DBモデリング3」を「未着手」の参加者一覧を取得する
条件に合致する参加者を全て取得するのではなく、10名ずつ取得する点（ページング）にご注意ください！
ヒント：CQRSを使い、RepositoryではなくQueryServiceに処理を記載すると良いかもしれません


以下の階層が存在すること
Controller
App(もしくはUsecase)
Infra
Db
QueryService
Repository
Domain
DomainService
Entity


補足仕様

Prismaを使ってデータの永続化ができること（サンプルレポジトリにはDocker化されたDBが用意されています。docker-compose upで起動して使ってみてください）
ユーザ認証は実装しなくても大丈夫です
認証が必要なエンドポイントの場合は、requestのbodyに「userId」が含まれていればOK、ぐらいの簡易的な作りで構いません
クッキーやセッションなどは気にしなくて構いません。リクエストに対してレスポンスを返すだけのシンプルなAPIサーバで十分です
課題の簡略化のため、初期データはバッチで投入されるためドメインロジックを介す必要がない前提とします
例えば参加者30人がペアやチームに割り振られた状況でスタートするようなイメージです
DomainとApp配下のコードには、少なくとも正常系の単体テストを書いてみましょう！
```

